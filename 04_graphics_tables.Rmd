---
title: "graphics_tables"
author: "Leandro Pereira Garcia"
date: "October 10, 2019"
output: word_document
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE)
options(scipen=999)
set.seed(233)
```


```{r include=FALSE}
#Libraries
library(readr)
library(tidyverse)
library(ggplot2)
library(sf)
library(spData)
library(ggpubr)
library(RColorBrewer)
library(gt)
```


```{r include=FALSE}
#Databases
pred <- read_csv("bases/impact_predictions.csv")
base_efi <- read_csv("bases/efficiency_analysis.csv")
```







```{r include=FALSE}
#Importing the world map
WorldData <- map_data('world')
WorldData %>% filter(region != "Antarctica") -> WorldData
WorldData <- fortify(WorldData)



#Adjustin countries names
pred$region_map <- pred$LOCATION
pred[which(pred$LOCATION == "Congo, Rep."), 52] <- "Republic of Congo"
pred[which(pred$LOCATION == "Egypt, Arab Rep."), 52] <- "Egypt"
pred[which(pred$LOCATION == "Korea, Rep."), 52] <- "South Korea"
pred[which(pred$LOCATION == "North Macedonia"), 52] <- "Macedonia"
pred[which(pred$LOCATION == "Russian Federation"), 52] <- "Russia"
pred[which(pred$LOCATION == "Trinidad and Tobago"), 52] <- "Trinidad"
pred[which(pred$LOCATION == "United Kingdom"), 52] <- "UK"
pred[which(pred$LOCATION == "United States"), 52] <- "USA"
pred[which(pred$LOCATION == "Brunei Darussalam"), 52] <- "Brunei"
pred[which(pred$LOCATION == "Congo, Dem. Rep."), 52] <- "Democratic Republic of the Congo"
pred[which(pred$LOCATION == "Gambia, The"), 52] <- "Gambia"
pred[which(pred$LOCATION == "Cote d'Ivoire"), 52] <- "Ivory Coast"
pred[which(pred$LOCATION == "Iran, Islamic Rep."), 52] <- "Iran"
pred[which(pred$LOCATION == "Kyrgyz Republic"), 52] <- "Kyrgyzstan"
pred[which(pred$LOCATION == "Lao PDR"), 52] <- "Laos"
pred[which(pred$LOCATION == "Slovak Republic"), 52] <- "Slovakia"
pred[which(pred$LOCATION == "Yemen, Rep."), 52] <- "Yemen"



# teste <- WorldData[,c(3,5)]
# teste$BASE <- "word"
# teste <- unique(teste[,c(2,3)])
# names(teste)[1] <- "region_map"
# pred_t <- pred[,c(2,52)]
# pred_t$BASE <- "pred"
# pred_t$INCOME_CLASS <- NULL
# teste <- merge(teste, pred_t, by = "region_map", all = T)

pred_map <- pred
pred_map <- merge(pred_map, WorldData, by.x = "region_map", by.y = "region", all.x = T)


base_efi$region_map <- base_efi$LOCATION
base_efi[which(base_efi$LOCATION == "Congo, Rep."), 60] <- "Republic of Congo"
base_efi[which(base_efi$LOCATION == "Egypt, Arab Rep."), 60] <- "Egypt"
base_efi[which(base_efi$LOCATION == "Korea, Rep."), 60] <- "South Korea"
base_efi[which(base_efi$LOCATION == "North Macedonia"), 60] <- "Macedonia"
base_efi[which(base_efi$LOCATION == "Russian Federation"), 60] <- "Russia"
base_efi[which(base_efi$LOCATION == "Trinidad and Tobago"), 60] <- "Trinidad"
base_efi[which(base_efi$LOCATION == "United Kingdom"), 60] <- "UK"
base_efi[which(base_efi$LOCATION == "United States"), 60] <- "USA"
base_efi[which(base_efi$LOCATION == "Brunei Darussalam"), 60] <- "Brunei"
base_efi[which(base_efi$LOCATION == "Congo, Dem. Rep."), 60] <- "Democratic Republic of the Congo"
base_efi[which(base_efi$LOCATION == "Gambia, The"), 60] <- "Gambia"
base_efi[which(base_efi$LOCATION == "Cote d'Ivoire"), 60] <- "Ivory Coast"
base_efi[which(base_efi$LOCATION == "Iran, Islamic Rep."), 60] <- "Iran"
base_efi[which(base_efi$LOCATION == "Kyrgyz Republic"), 60] <- "Kyrgyzstan"
base_efi[which(base_efi$LOCATION == "Lao PDR"), 60] <- "Laos"
base_efi[which(base_efi$LOCATION == "Slovak Republic"), 60] <- "Slovakia"
base_efi[which(base_efi$LOCATION == "Yemen, Rep."), 52] <- "Yemen"


base_map <- base_efi
base_map <- merge(base_map, WorldData, by.x = "region_map", by.y = "region", all.x = T)

```
Ao todo, foram utilizadas informações de 107 países, sendo 36 pobres e 71 não pobres. Os indicadores destes países antes e após a imputação estão exibidos nos Anexo 1 e 2.
Entre os países pobres, todos apresentaram redução na taxa de mortalidade neonatal e na taxa de mortalidade de crianças com idade de 28dias a 5 anos, entre 2016 e 2017. O país pobre com a maior redução na taxa de mortalidade neonatal  foi `r base_efi[which(base_efi$DELTA_RATE_NEO == min(base_efi$DELTA_RATE_NEO)),1]`, com uma variação de `r round(base_efi[which(base_efi$DELTA_RATE_NEO == min(base_efi$DELTA_RATE_NEO)),9],3)`. O país com a menor redução foi `r base_efi[which(base_efi$DELTA_RATE_NEO == max(base_efi$DELTA_RATE_NEO)),1]`, apresentando uma redução de `r round(base_efi[which(base_efi$DELTA_RATE_NEO == max(base_efi$DELTA_RATE_NEO)),9],3)`. Com relação à taxa de mortalidade de crianças com idade entre 28 dias e 5 anos, o pais com a maior redução foi `r base_efi[which(base_efi$DELTA_RATE_NEO_U5 == min(base_efi$DELTA_RATE_NEO_U5)),1]` e com o com a menor `r base_efi[which(base_efi$DELTA_RATE_NEO_U5 == max(base_efi$DELTA_RATE_NEO_U5)),1]`, com variações de `r round(base_efi[which(base_efi$DELTA_RATE_NEO_U5 == min(base_efi$DELTA_RATE_NEO_U5)),11],3)` e `r round(base_efi[which(base_efi$DELTA_RATE_NEO_U5 == max(base_efi$DELTA_RATE_NEO_U5)),11],3)`, respectivamente.
Com relação à variação da entre os gastos públicos (tratamento), todos os países pobres apresentaram aumento entre 2013 e 2014. O país com a maior variação foi `r base_efi[which(base_efi$PUBLIC_EXP_LAGGED2 == max(base_efi$PUBLIC_EXP_LAGGED2)),1]`, U\$`r round(base_efi[which(base_efi$PUBLIC_EXP_LAGGED2 == max(base_efi$PUBLIC_EXP_LAGGED2)),16],2)`; dois países apresentaram a menor: `r base_efi[which(base_efi$PUBLIC_EXP_LAGGED2 == min(base_efi$PUBLIC_EXP_LAGGED2)),1][1,]` e `r base_efi[which(base_efi$PUBLIC_EXP_LAGGED2 == min(base_efi$PUBLIC_EXP_LAGGED2)),1][2,]`: U\$`r round(base_efi[which(base_efi$PUBLIC_EXP_LAGGED2 == min(base_efi$PUBLIC_EXP_LAGGED2)),16][1,],2)`. A receita tributária (variável instrumental) apresentou variações positivas e negativas entre este grupo de países, sendo aquele com maior variação  `r base_efi[which(base_efi$PLUS_65_YEARS_LAGGED == max(base_efi$PLUS_65_YEARS_LAGGED)),1]`, U\$`r round(base_efi[which(base_efi$PLUS_65_YEARS_LAGGED == max(base_efi$PLUS_65_YEARS_LAGGED)),17],2)`; e o com a menor  `r base_efi[which(base_efi$PLUS_65_YEARS_LAGGED == min(base_efi$PLUS_65_YEARS_LAGGED)),1]`, U\$`r round(base_efi[which(base_efi$PLUS_65_YEARS_LAGGED == min(base_efi$PLUS_65_YEARS_LAGGED)),17],2)`. (Figura 1)

```{r fig.width=10, fig.height=6}
#Neontal, 28d<U5, Tax, Public Expenditure distribution
myPalette <- colorRampPalette(rev(brewer.pal(11, "Spectral")))

pred_mapa_neo <- dplyr::select(pred_map, c(region_map, DELTA_RATE_NEO))
plot1 <- ggplot()+
        geom_map(data=WorldData, map=WorldData,
                  aes(x=long, y=lat, group=group, map_id=region),
                  fill="white", colour="#7f7f7f", size=0.5)+
        geom_map(data=pred_mapa_neo, map=WorldData,
                  aes(fill= DELTA_RATE_NEO, map_id=region_map),
                  colour="#7f7f7f", size=0.5)+
        coord_map("rectangular", lat0=0, xlim=c(-190,190), ylim=c(-60, 90))+
        labs(fill="Var Neo 2016-2015", x="", y="")+
        theme_bw()+
        theme(panel.border = element_blank())+
        scale_fill_gradientn(colours = myPalette(100), 
                             labels = round(quantile(pred$DELTA_RATE_NEO, c(.05,.95)),3), 
                             breaks = round(quantile(pred$DELTA_RATE_NEO, c(.05,.95)),3))

pred_mapa_neo_u5 <- dplyr::select(pred_map, c(region_map, DELTA_RATE_NEO_U5))
plot2 <- ggplot()+
        geom_map(data=WorldData, map=WorldData,
                  aes(x=long, y=lat, group=group, map_id=region),
                  fill="white", colour="#7f7f7f", size=0.5)+
        geom_map(data=pred_mapa_neo_u5, map=WorldData,
                  aes(fill= DELTA_RATE_NEO_U5, map_id=region_map),
                  colour="#7f7f7f", size=0.5)+
        coord_map("rectangular", lat0=0, xlim=c(-190,190), ylim=c(-60, 90))+
        labs(fill="Var 28d<uy 2016-2015", x="", y="")+
        theme_bw()+
        theme(panel.border = element_blank())+
        scale_fill_gradientn(colours = myPalette(100), 
                             labels = round(quantile(pred$DELTA_RATE_NEO_U5, c(.05,.95)),3), 
                             breaks = round(quantile(pred$DELTA_RATE_NEO_U5, c(.05,.95)),3))

pred_mapa_public <- dplyr::select(pred_map, c(region_map, PUBLIC_EXP_LAGGED2))
plot3 <- ggplot()+
        geom_map(data=WorldData, map=WorldData,
                  aes(x=long, y=lat, group=group, map_id=region),
                  fill="white", colour="#7f7f7f", size=0.5)+
        geom_map(data=pred_mapa_public, map=WorldData,
                  aes(fill= PUBLIC_EXP_LAGGED2, map_id=region_map),
                  colour="#7f7f7f", size=0.5)+
        coord_map("rectangular", lat0=0, xlim=c(-190,190), ylim=c(-60, 90))+
        labs(fill="Var Pub Exp 2012-2011", x="", y="")+
        theme_bw()+
        theme(panel.border = element_blank())+
        scale_fill_gradientn(colours = myPalette(100), 
                             labels = round(quantile(pred$PUBLIC_EXP_LAGGED2, c(.05,.95)),0), 
                             breaks = round(quantile(pred$PUBLIC_EXP_LAGGED2, c(.05,.95)),0))

pred_mapa_tax <- dplyr::select(pred_map, c(region_map, PLUS_65_YEARS_LAGGED))
plot4 <- ggplot()+
        geom_map(data=WorldData, map=WorldData,
                  aes(x=long, y=lat, group=group, map_id=region),
                  fill="white", colour="#7f7f7f", size=0.5)+
        geom_map(data=pred_mapa_tax, map=WorldData,
                  aes(fill= PLUS_65_YEARS_LAGGED, map_id=region_map),
                  colour="#7f7f7f", size=0.5)+
        coord_map("rectangular", lat0=0, xlim=c(-190,190), ylim=c(-60, 90))+
        labs(fill="Var Tax 2010-2009", x="", y="")+
        theme_bw()+
        theme(panel.border = element_blank())+
        scale_fill_gradientn(colours = myPalette(100), 
                             labels = round(quantile(pred$PLUS_65_YEARS_LAGGED, c(.05,.95)),0), 
                             breaks = round(quantile(pred$PLUS_65_YEARS_LAGGED, c(.05,.95)),0))

ggarrange(plot1, plot2, plot3, plot4, labels = c("A", "B", "C", "D"),
           common.legend = F,legend = "bottom")



```






```{r }
#Association between the treatment and the instrumental variable
pred_regr <- pred[,c(12:14,16:45)]
lm(PUBLIC_EXP_LAGGED2 ~ ., pred_regr) %>% summary()
```

```{r impact_predictions}
# Create a gt table of impact per group of development
pred[which(pred$INCOME_CLASS == "L"), 2] <- "Low"
pred[which(pred$INCOME_CLASS == "LM"), 2] <- "Low-Median"
pred[which(pred$INCOME_CLASS == "UM"), 2] <- "Upper-Median"
pred[which(pred$INCOME_CLASS == "H"), 2] <- "High"
pred$INCOME_CLASS <- factor(pred$INCOME_CLASS, levels = c("Low", "Low-Median", "Upper-Median", "High"))
#pred[,c(47:52)] <- pred[,c(47:52)]*1000
pred$IC_NEO <- paste0("(CI95%",round(pred$IC_05_NEO,7), " ", round(pred$IC_95_NEO,7),")")
pred$IC_NEO_U5 <- paste0("(CI95%",round(pred$IC_05_NEO_U5,7), " ", round(pred$IC_95_NEO_U5,7),")")


pred_table <- subset(pred, pred$INCOME_CLASS %in% c("Low", "Low-Median"))
pred_table <- pred_table %>%
     dplyr::select("LOCATION", "DELTA_RATE_NEO", 
                   "DELTA_RATE_NEO_U5", "PUBLIC_EXP_LAGGED2", "PRED_NEO", "IC_NEO",
                   "PRED_NEO_U5", "IC_NEO_U5")
knitr::kable(pred_table)

```




#Efectivenes-Efficiency relation neo
```{r fig.width=16, fig.height=8}


plot1 <- ggplot(base_efi,aes(EFI, PRED_NEO))+
            geom_text(label = base_efi$LOCATION,check_overlap = T, size =3)+
            geom_vline(xintercept = median(base_efi$EFI))+
            geom_hline(yintercept = median(base_efi$PRED_NEO))+
            geom_smooth(method = "lm")+
            labs(y = "Impact Neo", x = "Efficiency Neo")+
            theme_bw()
      
plot2 <- ggplot(base_efi,aes(EFI, PRED_NEO_U5))+
            geom_text(label = base_efi$LOCATION,check_overlap = T, size =3)+
            geom_vline(xintercept = median(base_efi$EFI))+
            geom_hline(yintercept = median(base_efi$PRED_NEO_U5))+
            geom_smooth(method = "lm")+
            labs(y = "Impact 28d>5y", x = "Efficiency 28d>5y")+
            theme_bw()

ggarrange(plot1, plot2, ncol = 2, labels = c("A", "B"))
```




```{r }
#neo,tag_neo, 28d<U5, targ_28d<U5 distribution
myPalette <- colorRampPalette(brewer.pal(11, "Spectral"))

base_mapa_pred_neo <- dplyr::select(base_map, c(region_map, PRED_NEO))
plot1 <- ggplot()+
        geom_map(data=WorldData, map=WorldData,
                  aes(x=long, y=lat, group=group, map_id=region),
                  fill="white", colour="#7f7f7f", size=0.5)+
        geom_map(data=base_mapa_pred_neo, map=WorldData,
                  aes(fill= PRED_NEO, map_id=region_map),
                  colour="#7f7f7f", size=0.5)+
        coord_map("rectangular", lat0=0, xlim=c(-190,190), ylim=c(-60, 90))+
        labs(fill="Impact", x="", y="")+
        theme_bw()+
        theme(panel.border = element_blank())+
        scale_fill_gradientn(colours = myPalette(100), 
                             labels = round(quantile(pred$PRED_NEO, c(.05,.95)),3), 
                             breaks = round(quantile(pred$PRED_NEO, c(.05,.95)),3))

base_mapa_targ_neo <- dplyr::select(base_map, c(region_map, TARG_PRED_NEO))
plot2 <- ggplot()+
        geom_map(data=WorldData, map=WorldData,
                  aes(x=long, y=lat, group=group, map_id=region),
                  fill="white", colour="#7f7f7f", size=0.5)+
        geom_map(data=base_mapa_targ_neo, map=WorldData,
                  aes(fill= TARG_PRED_NEO, map_id=region_map),
                  colour="#7f7f7f", size=0.5)+
        coord_map("rectangular", lat0=0, xlim=c(-190,190), ylim=c(-60, 90))+
        labs(fill="Efficient impact neo", x="", y="")+
        theme_bw()+
        theme(panel.border = element_blank())+
        scale_fill_gradientn(colours = myPalette(100), 
                             labels = round(quantile(pred$TARG_PRED_NEO, c(.05,.95)),3), 
                             breaks = round(quantile(pred$TARG_PRED_NEO, c(.05,.95)),3))

base_mapa_pred_neo_u5 <- dplyr::select(base_map, c(region_map, PRED_NEO_U5))
plot3 <- ggplot()+
        geom_map(data=WorldData, map=WorldData,
                  aes(x=long, y=lat, group=group, map_id=region),
                  fill="white", colour="#7f7f7f", size=0.5)+
        geom_map(data=base_mapa_pred_neo_u5, map=WorldData,
                  aes(fill= PRED_NEO_U5, map_id=region_map),
                  colour="#7f7f7f", size=0.5)+
        coord_map("rectangular", lat0=0, xlim=c(-190,190), ylim=c(-60, 90))+
        labs(fill="Current impact 28d<u5", x="", y="")+
        theme_bw()+
        theme(panel.border = element_blank())+
        scale_fill_gradientn(colours = myPalette(100), 
                             labels = round(quantile(pred$PRED_NEO_U5, c(.05,.95)),3), 
                             breaks = round(quantile(pred$PRED_NEO_U5, c(.05,.95)),3))

base_mapa_targ_neo_u5 <- dplyr::select(base_map, c(region_map, TARG_PRED_NEO_U5))
plot4 <- ggplot()+
        geom_map(data=WorldData, map=WorldData,
                  aes(x=long, y=lat, group=group, map_id=region),
                  fill="white", colour="#7f7f7f", size=0.5)+
        geom_map(data=base_mapa_targ_neo_u5, map=WorldData,
                  aes(fill= TARG_PRED_NEO_U5, map_id=region_map),
                  colour="#7f7f7f", size=0.5)+
        coord_map("rectangular", lat0=0, xlim=c(-190,190), ylim=c(-60, 90))+
        labs(fill="Efficient impact 28d<u5", x="", y="")+
        theme_bw()+
        theme(panel.border = element_blank())+
        scale_fill_gradientn(colours = myPalette(100), 
                             labels = round(quantile(pred$TARG_PRED_NEO_U5, c(.05,.95)),3), 
                             breaks = round(quantile(pred$TARG_PRED_NEO_U5, c(.05,.95)),3))


ggarrange(plot1, plot2, plot3, plot4, labels = c("A", "B", "C", "D"),
           common.legend = F,legend = "bottom")



```


```{r }
#health, targ_health, non_health, targ_non_health
myPalette <- colorRampPalette(brewer.pal(11, "Spectral"))
exp <- scale_fill_gradientn(colours = myPalette(10), limits=c(0, 11))


base_mapa_health <- dplyr::select(base_map, c(region_map, HEALTH))
plot1 <- ggplot()+
        geom_map(data=WorldData, map=WorldData,
                  aes(x=long, y=lat, group=group, map_id=region),
                  fill="white", colour="#7f7f7f", size=0.5)+
        geom_map(data=base_mapa_health, map=WorldData,
                  aes(fill= log(HEALTH), map_id=region_map),
                  colour="#7f7f7f", size=0.5)+
        coord_map("rectangular", lat0=0, xlim=c(-190,190), ylim=c(-60, 90))+
        labs(fill="Logged value", x="", y="")+
        theme_bw()+
        theme(panel.border = element_blank())+
        exp

base_mapa_targ_health <- dplyr::select(base_map, c(region_map, TARG_HEALTH))
plot2 <- ggplot()+
        geom_map(data=WorldData, map=WorldData,
                  aes(x=long, y=lat, group=group, map_id=region),
                  fill="white", colour="#7f7f7f", size=0.5)+
        geom_map(data=base_mapa_targ_health, map=WorldData,
                  aes(fill= log(TARG_HEALTH), map_id=region_map),
                  colour="#7f7f7f", size=0.5)+
        coord_map("rectangular", lat0=0, xlim=c(-190,190), ylim=c(-60, 90))+
        labs(fill="Efficient health exp", x="", y="")+
        theme_bw()+
        theme(panel.border = element_blank())+
        exp

base_mapa_non_health <- dplyr::select(base_map, c(region_map, NON_HEALTH))
plot3 <- ggplot()+
        geom_map(data=WorldData, map=WorldData,
                  aes(x=long, y=lat, group=group, map_id=region),
                  fill="white", colour="#7f7f7f", size=0.5)+
        geom_map(data=base_mapa_non_health, map=WorldData,
                  aes(fill= log(NON_HEALTH), map_id=region_map),
                  colour="#7f7f7f", size=0.5)+
        coord_map("rectangular", lat0=0, xlim=c(-190,190), ylim=c(-60, 90))+
        labs(fill="Current non health exp", x="", y="")+
        theme_bw()+
        theme(panel.border = element_blank())+
        exp

base_mapa_targ_non_health <- dplyr::select(base_map, c(region_map, TARG_NON_HEALTH))
plot4 <- ggplot()+
        geom_map(data=WorldData, map=WorldData,
                  aes(x=long, y=lat, group=group, map_id=region),
                  fill="white", colour="#7f7f7f", size=0.5)+
        geom_map(data=base_mapa_targ_non_health, map=WorldData,
                  aes(fill= log(TARG_NON_HEALTH), map_id=region_map),
                  colour="#7f7f7f", size=0.5)+
        coord_map("rectangular", lat0=0, xlim=c(-190,190), ylim=c(-60, 90))+
        labs(fill="Efficient non health exp", x="", y="")+
        theme_bw()+
        theme(panel.border = element_blank())+
        exp


ggarrange(plot1, plot2, plot3, plot4, labels = c("A", "B", "C", "D"),
           common.legend = F,legend = "bottom")




```







#Proportion of Public Health Spending and Efectiveness
##Impact Neo
```{r }

lm(PRED_NEO ~ PROP_PUBLIC_HEALTH_EXP_LAGGED2, subset(base_efi,base_efi$INCOME_CLASS %in% c("L", "LM"))) %>%
   summary()

```




##Impact 28d<u5
```{r }

lm(PRED_NEO_U5 ~ PROP_PUBLIC_HEALTH_EXP_LAGGED2, subset(base_efi,base_efi$INCOME_CLASS %in% c("L", "LM"))) %>%
   summary()

```




#Proportion of Public Health Spending and Eficiency


```{r }

lm(EFI ~ PROP_PUBLIC_HEALTH_EXP_LAGGED2, subset(base_efi,base_efi$INCOME_CLASS %in% c("L", "LM"))) %>%
   summary()

```


```{r }

theme_new <- function() {
  theme(plot.title = element_text(hjust=0.5),
        axis.text.x.top = element_blank(), # remove ticks/text on labels
        axis.ticks.x.top = element_blank(),
        
        ,
        axis.title.x.bottom = element_blank(), # remove titles
        axis.title.y.left = element_blank())
}

plot1 <- ggplot(base_efi, aes( PROP_PUBLIC_HEALTH_EXP_LAGGED2,PRED_NEO))+
            geom_jitter(aes(color = LOCATION))+
            geom_smooth(method = "lm", se = F)+
            labs(fill="", x="", y="Impact Neo")+
            theme_bw()+ 
            theme(legend.position = "none") 
plot2 <- ggplot(base_efi, aes( PROP_PUBLIC_HEALTH_EXP_LAGGED2,PRED_NEO_U5))+
            geom_jitter(aes(color = LOCATION))+
            geom_smooth(method = "lm", se = F)+
            labs(fill="", x="", y="Impact Neo")+
            theme_bw()+ 
            theme(legend.position = "none") 
plot3 <- ggplot(base_efi, aes( PROP_PUBLIC_HEALTH_EXP_LAGGED2,EFI))+
            geom_jitter(aes(color = LOCATION))+
            geom_smooth(method = "lm", se = F)+
            labs(fill="", x="Proportion of Public Expenditure on", y="Impact Neo")+
            theme_bw()+ 
            theme(legend.position = "none") 
ggarrange(plot1, plot2, plot3, nrow = 3, labels = c("A", "B", "C"))

```


